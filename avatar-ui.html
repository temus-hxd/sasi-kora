<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReadyPlayerMe Avatar with Claude AI Chatbot</title>
  <link rel="stylesheet" href="css/styles.css">

  <!-- Load Three.js and TalkingHead dependencies directly -->
  <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
  <script type="importmap">
  { "imports": {
      "three": "https://unpkg.com/three@0.170.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.170.0/examples/jsm/",
      "talkinghead": "https://cdn.jsdelivr.net/gh/met4citizen/TalkingHead@1.5/modules/talkinghead.mjs"
    }
  }
  </script>
</head>

<body>
  <!-- Korav4-style Loading Screen -->
  <!-- TEMPORARILY DISABLED FOR DEBUGGING -->
  <div class="loading-screen hidden" id="loadingScreen" style="display: none !important;">
    <div class="loading-title">RPM-HCC</div>
    <div class="loading-subtitle">Claude AI Avatar Assistant</div>
    <div class="loading-counter" id="loadingCounter">0%</div>
    <div class="loading-progress">
      <div class="loading-progress-bar" id="loadingProgressBar"></div>
    </div>
    <div class="loading-text" id="loadingText">Initializing...</div>
  </div>

  <div class="container">
    <div class="avatar-section">
      <div id="avatar"></div>
      <div class="status" id="status">ðŸš€ Initializing ReadyPlayerMe Avatar with Claude AI...</div>
      
      <!-- Speech Bubble -->
      <div class="speech-bubble" id="speechBubble">
        <div class="speech-bubble-content">
          <div class="speech-bubble-tail"></div>
          <div class="speech-bubble-tail-inner"></div>
          <div id="speechBubbleText"></div>
        </div>
      </div>
      
      <!-- ================================ -->
      <!-- CONFETTI APPRECIATION SYSTEM     -->
      <!-- ================================ -->
      <!-- Triggers when user shows appreciation like "Thanks", "I love you", "You look good" -->
      <div class="confetti-container" id="confettiContainer" aria-hidden="true">
        <!-- Hearts will be dynamically generated here -->
      </div>
      <!-- ================================ -->
      <!-- END CONFETTI SYSTEM              -->
      <!-- ================================ -->

      <!-- Knowledge Base Thinking Bubble -->
      <div class="knowledge-base-thinking" id="knowledgeBaseThinking">
        <div class="knowledge-base-thinking-content">
          <div class="kb-thinking-icon">ðŸ§ </div>
          <div class="kb-thinking-text">give me a moment while i check</div>
          <div class="kb-thinking-dots">...</div>
          <div class="knowledge-base-thinking-tail">
            <div class="thinking-circle"></div>
            <div class="thinking-circle"></div>
            <div class="thinking-circle"></div>
          </div>
        </div>
      </div>
      

      <!-- Events Thinking Bubble -->
      <div class="events-thinking" id="eventsThinking">
        <div class="events-thinking-content">
          <div class="events-thinking-icon">ðŸ“…</div>
          <div class="events-thinking-text">let me check the calendar</div>
          <div class="events-thinking-dots">...</div>
          <div class="events-thinking-tail">
            <div class="thinking-circle"></div>
            <div class="thinking-circle"></div>
            <div class="thinking-circle"></div>
          </div>
        </div>
      </div>

      <!-- Book Cover Display -->
      <div class="book-cover-display" id="bookCoverDisplay">
        <div class="books-header" id="singleBookHeader">Featured Book</div>
        <div class="book-cover-container">
          <div class="book-cover-loading u-hidden" id="bookCoverLoading"></div>
          <img class="book-cover-image u-hidden" id="bookCoverImage" />
          <div class="book-cover-title" id="bookCoverTitle"></div>
          <div class="book-cover-author" id="bookCoverAuthor"></div>
        </div>
      </div>

      <!-- Multiple Books Display -->
      <div class="multiple-books-display" id="multipleBooksDisplay">
        <div class="books-header" id="booksHeader">Recommended Books</div>
        <div class="books-grid" id="booksGrid"></div>
      </div>

      <!-- Single Leadership Display -->
      <div class="leadership-display" id="leadershipDisplay">
        <div class="leadership-header" id="singleLeaderHeader">Leadership Team</div>
        <div class="leadership-container">
          <div class="leadership-loading u-hidden" id="leadershipLoading"></div>
          <img class="leadership-image u-hidden" id="leadershipImage" />
          <div class="leadership-name" id="leadershipName"></div>
          <div class="leadership-title" id="leadershipTitle"></div>
        </div>
      </div>

      <!-- Multiple Leadership Display -->
      <div class="leadership-multiple-display" id="leadershipMultipleDisplay">
        <div class="leadership-header" id="leadershipMultipleHeader">Leadership Team</div>
        <div class="leadership-grid" id="leadershipGrid"></div>
      </div>

      <!-- Link Buttons Container -->
      <div class="link-buttons-container" id="linkButtonsContainer">
        <!-- Buttons will be dynamically generated here -->
      </div>
    </div>

    <!-- KORAV4-STYLE CHAT INPUT -->
    <div class="chat-input-container">
      <!-- Status Indicator -->
      <div class="claude-status-indicator u-hidden" id="claudeStatusIndicator">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Ready</span>
      </div>
      
      <div class="chat-input-form">
        <!-- Mic Button -->
        <button
          id="micBtn"
          onclick="toggleVoice()"
          class="input-icon-button mic-button"
          title="Voice input"
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
            <line x1="12" y1="19" x2="12" y2="23"/>
            <line x1="8" y1="23" x2="16" y2="23"/>
          </svg>
        </button>
        
        <!-- Text Input -->
        <input
          type="text"
          id="messageInput"
          class="main-text-input"
          placeholder="Talk to me..."
          maxlength="500"
          onkeypress="handleKeyPress(event)"
        />
        
        <!-- Send Button -->
        <button
          class="input-icon-button send-button"
          id="sendBtn"
          onclick="sendMessage()"
          title="Send message"
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"/>
            <polygon points="22,2 15,22 11,13 2,9"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Debug buttons will be created by JavaScript -->

    <!-- Hidden controls section -->
    <div class="controls-section">
    </div>
  </div>

  <!-- Load AnimationManager before app.js -->
  <script src="js/AnimationManager.js"></script>
  
  <!-- Load BrowserMemory for persistent conversation context -->
  <script src="js/browser-memory.js"></script>
  
  <!-- ================================ -->
  <!-- CONFETTI APPRECIATION SYSTEM     -->
  <!-- ================================ -->
  <script src="js/ConfettiManager.js"></script>
  <!-- ================================ -->
  
  <!-- Main app initialization -->
  <!-- app.js imports all managers (LeadershipManager, LinkButtonManager, etc.) -->
  <!-- No need to load them separately - ES modules handle dependencies automatically -->
  <!-- Cache busting: Use timestamp to force fresh load -->
  <script type="module" src="js/app.js?v=20250127-003"></script>
</body>
</html>
